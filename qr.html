<!DOCTYPE html>
<html lang="vi">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>M√£ QR trang ch√∫c m·ª´ng sinh nh·∫≠t</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
	<style>
		:root {
			--bg: #0f1226;
			--panel: #171a36;
			--text: #ffffff;
			--muted: #c9c9d6;
			--accent: #6ef3ff;
			--accent-2: #ff6ec7;
		}
		* { box-sizing: border-box; }
		body {
			margin: 0;
			min-height: 100vh;
			font-family: "Poppins", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
			color: var(--text);
			background: radial-gradient(1200px 800px at 20% -10%, #1d2148 0%, #0f1226 55%) no-repeat, #0f1226;
			display: grid;
			place-items: center;
			padding: 24px 16px;
		}
		.panel {
			width: 100%;
			max-width: 760px;
			background: linear-gradient(165deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));
			border: 1px solid rgba(255,255,255,0.1);
			border-radius: 16px;
			padding: 22px;
			box-shadow: 0 10px 30px rgba(0,0,0,0.35);
		}
		h1 {
			margin: 0 0 8px;
			font-size: 28px;
			background: linear-gradient(90deg, #fff, #ffe3f6, #bff7ff);
			-webkit-background-clip: text;
			background-clip: text;
			color: transparent;
		}
		p { margin: 0 0 16px; color: var(--muted); }
		.row {
			display: grid;
			grid-template-columns: 1fr auto;
			gap: 10px;
			margin-bottom: 16px;
		}
		/* ·∫®n h√†ng nh·∫≠p li·ªáu v√¨ trang s·∫Ω t·ª± sinh QR */
		.row.auto-hidden { display: none; }
		input[type="url"] {
			width: 100%;
			padding: 12px 14px;
			border-radius: 12px;
			border: 1px solid rgba(255,255,255,0.14);
			background: rgba(0,0,0,0.18);
			color: #fff;
			font-size: 15px;
			outline: none;
		}
		.btn {
			padding: 12px 16px;
			border-radius: 12px;
			border: 0;
			cursor: pointer;
			font-weight: 600;
			color: #0b0b16;
			background: linear-gradient(135deg, var(--accent), var(--accent-2));
			box-shadow: 0 10px 24px rgba(110, 243, 255, 0.25), 0 6px 16px rgba(255, 110, 199, 0.22);
		}
		.grid {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 16px;
		}
		.card {
			border: 1px solid rgba(255,255,255,0.12);
			background: rgba(0,0,0,0.18);
			border-radius: 14px;
			padding: 14px;
			text-align: center;
		}
		.preview {
			display: grid;
			place-items: center;
			padding: 12px;
			background: #fff;
			border-radius: 12px;
			min-height: 260px;
		}
		.info {
			font-size: 13px; color: var(--muted);
		}
		.actions {
			display: flex;
			justify-content: center;
			gap: 10px;
			margin-top: 10px;
		}
		.btn-ghost {
			padding: 10px 14px;
			border-radius: 12px;
			border: 1px solid rgba(255,255,255,0.16);
			background: rgba(255,255,255,0.06);
			color: #fff;
			cursor: pointer;
		}
		a.link { color: #9fe9ff; text-decoration: none; }
		@media (max-width: 700px){ .grid { grid-template-columns: 1fr; } }
	</style>
</head>
<body>
	<div class="panel">
		<h1>M√£ QR cho trang sinh nh·∫≠t üéâ</h1>
		<p>Qu√©t m√£ d∆∞·ªõi ƒë√¢y ƒë·ªÉ m·ªü trang <code>index.html</code> tr√™n ch√≠nh t√™n mi·ªÅn hi·ªán t·∫°i. B·∫°n c√≥ th·ªÉ t·∫£i ·∫£nh PNG n·∫øu mu·ªën in/chi s·∫ª.</p>
		<div class="row auto-hidden">
			<input type="url" id="url" placeholder="https://v√≠-d·ª•.com/sinh-nhat" spellcheck="false">
			<button class="btn" id="gen">T·∫°o m√£ QR</button>
		</div>
		<div class="grid">
			<div class="card">
				<div class="preview" id="preview">
					<span class="info">M√£ QR s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y</span>
				</div>
				<div class="actions">
					<button class="btn-ghost" id="download" disabled>T·∫£i PNG</button>
					<button class="btn-ghost" id="openImg" disabled>M·ªü ·∫£nh</button>
				</div>
			</div>
			<div class="card" style="text-align:left">
				<h3 style="margin:6px 0 8px">M·∫πo nhanh</h3>
				<ul style="margin:8px 0 12px 18px; padding:0; line-height:1.8">
					<li>N·∫øu d√πng trong m·∫°ng LAN, nh·∫≠p URL nh∆∞: <code>http://IP-m√°y-t√≠nh:5500/index.html</code></li>
					<li>N·∫øu ch∆∞a xu·∫•t b·∫£n, b·∫°n c√≥ th·ªÉ t·∫°m d√πng ƒë∆∞·ªùng d·∫´n t·ªõi m·ªôt trang c√≥ th·ªÉ truy c·∫≠p c√¥ng khai.</li>
					<li>M√£ QR ƒë∆∞·ª£c t·∫°o b·∫±ng d·ªãch v·ª• h√¨nh ·∫£nh c·ªßa Google (an to√†n, mi·ªÖn ph√≠).</li>
				</ul>
				<p>Quay l·∫°i trang ch√∫c m·ª´ng: <a class="link" href="index.html">index.html</a></p>
			</div>
		</div>
	</div>
	<script>
		// Generate QR via Google Chart API (simple, no dependency)
		const input = document.getElementById('url');
		const genBtn = document.getElementById('gen');
		const preview = document.getElementById('preview');
		const dlBtn = document.getElementById('download');
		const openBtn = document.getElementById('openImg');
		let lastImg = null;

		function isValidUrl(u){
			try { new URL(u); return true; } catch { return false; }
		}

		function buildQrSrc(u, size = 512){
			const enc = encodeURIComponent(u);
			return `https://chart.googleapis.com/chart?cht=qr&chs=${size}x${size}&chld=L|0&chl=${enc}`;
		}

		function clearPreview(){
			preview.innerHTML = '<span class="info">M√£ QR s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y</span>';
			dlBtn.disabled = true;
			openBtn.disabled = true;
			lastImg = null;
		}

		function renderQrFromUrl(url){
			const img = new Image();
			img.crossOrigin = 'anonymous';
			img.alt = 'QR code';
			img.width = 320;
			img.height = 320;
			img.src = buildQrSrc(url, 512);
			img.onload = () => {
				preview.innerHTML = '';
				preview.appendChild(img);
				lastImg = img;
				dlBtn.disabled = false;
				openBtn.disabled = false;
			};
			img.onerror = () => {
				alert('Kh√¥ng t·∫°o ƒë∆∞·ª£c m√£ QR. Vui l√≤ng th·ª≠ l·∫°i.');
				clearPreview();
			};
		}

		async function toPngBlobFromImg(imgEl){
			const canvas = document.createElement('canvas');
			const s = Math.max(imgEl.naturalWidth, 512);
			canvas.width = s;
			canvas.height = s;
			const ctx = canvas.getContext('2d');
			ctx.fillStyle = '#ffffff';
			ctx.fillRect(0,0,s,s);
			const scale = s / imgEl.naturalWidth;
			const w = imgEl.naturalWidth * scale;
			const h = imgEl.naturalHeight * scale;
			ctx.drawImage(imgEl, 0, 0, w, h);
			return new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
		}

		// Gi·ªØ l·∫°i s·ª± ki·ªán c≈© n·∫øu c·∫ßn b·∫≠t l·∫°i √¥ nh·∫≠p trong t∆∞∆°ng lai
		if (genBtn) {
			genBtn.addEventListener('click', async () => {
				const url = input.value.trim();
				if (!isValidUrl(url)) {
					alert('Vui l√≤ng nh·∫≠p m·ªôt ƒë∆∞·ªùng link h·ª£p l·ªá (b·∫Øt ƒë·∫ßu b·∫±ng http/https).');
					clearPreview();
					return;
				}
				renderQrFromUrl(url);
			});
		}

		dlBtn.addEventListener('click', async () => {
			if (!lastImg) return;
			const blob = await toPngBlobFromImg(lastImg);
			const a = document.createElement('a');
			a.href = URL.createObjectURL(blob);
			a.download = 'qr-sinh-nhat.png';
			a.click();
			setTimeout(() => URL.revokeObjectURL(a.href), 1000);
		});

		openBtn.addEventListener('click', async () => {
			if (!lastImg) return;
			const blob = await toPngBlobFromImg(lastImg);
			const url = URL.createObjectURL(blob);
			window.open(url, '_blank');
			setTimeout(() => URL.revokeObjectURL(url), 30000);
		});

		// T·ª± ƒë·ªông sinh m√£ QR cho index.html c√πng domain khi m·ªü trang
		(function autoGenerate() {
			try {
				const base = new URL(window.location.href);
				// N·∫øu ng∆∞·ªùi d√πng ƒë·ªïi t√™n file, v·∫´n ∆∞u ti√™n tr·ªè t·ªõi index.html ·ªü c√πng th∆∞ m·ª•c
				base.pathname = base.pathname.replace(/[^/]+$/i, 'index.html');
				const targetUrl = base.toString();
				if (input) input.value = targetUrl;
				renderQrFromUrl(targetUrl);
			} catch {
				// Fallback: tr·ªè t·ªõi g·ªëc site
				renderQrFromUrl(window.location.origin);
			}
		})();
	</script>
</body>
</html>


